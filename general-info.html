<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>General Information</title>
    <style>
        /* Allgemeine Modal-Styles, die auch in index.html sein sollten */
        .modal {
          display: none; /* Versteckt das Modal standardmäßig */
          position: fixed; /* Über dem gesamten Bildschirm */
          z-index: 2000; /* Ganz oben */
          left: 0;
          top: 0;
          width: 100%;
          height: 100%;
          overflow: auto;
          background-color: rgba(0,0,0,0.4); /* Dunkler Hintergrund */
          justify-content: center; /* Zentriert Inhalt */
          align-items: center; /* Zentriert Inhalt */
        }

        .modal-content {
          background-color: #fefefe;
          margin: auto;
          padding: 20px;
          border: 1px solid #888;
          width: 80%;
          max-width: 600px; /* Max-Breite für Modal-Inhalt */
          border-radius: 10px;
          box-shadow: 0 4px 8px rgba(0,0,0,0.2);
          position: relative;
        }

        .close-button {
          color: #aaa;
          float: right;
          font-size: 28px;
          font-weight: bold;
          position: absolute;
          right: 15px;
          top: 10px;
          cursor: pointer;
        }

        .close-button:hover,
        .close-button:focus {
          color: black;
          text-decoration: none;
          cursor: pointer;
        }

        .modal-list-group {
            max-height: 250px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
        }

        .modal-list-group li {
            padding: 8px 0;
            cursor: pointer;
            border-bottom: 1px dotted #eee;
        }
        .modal-list-group li:last-child {
            border-bottom: none;
        }
        .modal-list-group li:hover {
            background-color: #f0f0f0;
        }

        /* Styles für die "Toolbar" */
        .toolbar {
            margin-bottom: 1em;
            display: flex;
            gap: 0.5em;
            flex-wrap: wrap; /* Ermöglicht Umbruch auf kleineren Bildschirmen */
        }
        .toolbar button {
            padding: 0.5em 1em;
            border: none;
            border-radius: 4px;
            color: #fff;
            cursor: pointer;
            transition: opacity 0.2s ease;
        }
        .toolbar button:hover {
            opacity: 0.9;
        }
        /* Spezifische Farben für Toolbar-Buttons */
        #toolbarNewPatientBtn { background: #4CAF50; } /* Grün */
        #toolbarNewPatientBtn:hover { background: #45a049; }
        #addNoteBoxBtn { background: #4a90e2; } /* Blau für Notiz-Button */
        #addNoteBoxBtn:hover { background: #3a7bd5; }
        #toolbarShowArchiveModalBtn { background: #4a90e2; } /* Blau */
        #toolbarShowArchiveModalBtn:hover { background: #3a7bd5; }
        #archiveCurrentPatientBtn { background: #e74c3c; } /* Rot */
        #archiveCurrentPatientBtn:hover { background: #d44d62; }


        /* Flexibleres Layout für info-container */
        .info-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        @media (min-width:768px) {
            .info-box.personal {
                grid-column: span 2; /* Persönliche Info-Box nimmt 2 Spalten auf größeren Bildschirmen */
            }
        }

        /* Allgemeine Info-Box Styles */
        .info-box {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .info-box h3 {
            color: #e85d75;
            margin-top: 0;
            margin-bottom: 15px;
        }
        .info-box p {
            margin-bottom: 8px;
        }
        .info-box strong {
            color: #333;
        }

        /* Patientenakte Grid-Layout */
        .patient-details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* Zwei Spalten */
            gap: 10px 15px; /* Vertikaler und horizontaler Abstand */
        }

        .patient-details-grid p {
            margin: 0; /* Entfernt Standard-Margin von p-Elementen */
        }

        .patient-details-grid .full-width {
            grid-column: 1 / -1; /* Nimmt die volle Breite ein */
        }

        .patient-actions {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        /* Fortschrittsbalken Styles */
        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 10px;
        }
        .progress {
            height: 100%;
            background-color: #d4a017;
            width: 0%; /* Wird durch JS gesetzt */
            text-align: center;
            color: white;
            line-height: 20px;
            transition: width 0.5s ease-in-out;
        }

        /* Styles für Buttons in info-box */
        .info-box button {
            padding: 8px 12px;
            background-color: #007bff; /* Blau für Standard-Buttons */
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            margin-right: 8px;
            transition: background-color 0.2s ease;
        }
        .info-box button:hover {
            background-color: #0056b3;
        }
        /* Spezifische Farbe für Löschen-Button */
        .info-box button#deletePatientBtn {
            background-color: #dc3545; /* Rot */
        }
        .info-box button#deletePatientBtn:hover {
            background-color: #c82333;
        }
        /* Spezifische Farbe für Abwählen-Button */
        .info-box button#clearPatientSelectionBtn {
            background-color: #6c757d; /* Grau */
        }
        .info-box button#clearPatientSelectionBtn:hover {
            background-color: #5a6268;
        }

        /* Notizen Box Styles */
        .info-box.notes-box {
            grid-column: 1 / -1; /* Notizbox nimmt immer volle Breite ein */
            margin-top: 20px;
        }

        .info-box.notes-box textarea {
            width: calc(100% - 20px);
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-family: Arial, sans-serif;
            font-size: 1em;
            resize: vertical;
            min-height: 150px;
            margin-bottom: 10px;
        }

        .info-box.notes-box button {
            padding: 10px 15px;
            background-color: #e85d75; /* Deine Akzentfarbe */
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.2s ease;
        }
        .info-box.notes-box button:hover {
            background-color: #d44d62;
        }

        /* Styles für neues Patientenformular */
        #newPatientForm {
            display: grid;
            grid-template-columns: 1fr 1fr; /* Zwei Spalten Layout */
            gap: 15px;
            margin-top: 20px;
        }

        #newPatientForm label {
            grid-column: 1 / 2; /* Label in erster Spalte */
            align-self: center;
            font-weight: bold; /* Labels fett */
        }
        #newPatientForm input,
        #newPatientForm select,
        #newPatientForm textarea {
            grid-column: 2 / 3; /* Eingabefelder in zweiter Spalte */
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: calc(100% - 16px); /* Passt Breite an Padding an */
            box-sizing: border-box; /* Padding und Border werden in die Breite einbezogen */
        }
        /* Textareas für volle Breite */
        #newPatientForm textarea#newHistory,
        #newPatientForm textarea#newTreatments,
        #newPatientForm textarea#newDiagnosis {
            grid-column: 1 / 3; /* Nimmt beide Spalten ein */
            width: 100%;
        }
        #newPatientForm label[for="newHistory"],
        #newPatientForm label[for="newTreatments"],
        #newPatientForm label[for="newDiagnosis"] {
            grid-column: 1 / 3; /* Labels für volle Textareas auch über beide Spalten */
        }

        #newPatientForm .actions {
            grid-column: 1 / 3; /* Buttons in voller Breite am Ende */
            display: flex;
            justify-content: flex-end;
            gap: 0.5em;
            margin-top: 10px;
        }
        #newPatientForm .actions button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            color: white;
        }
        #newPatientForm .actions .cancel { background: #ccc; }
        #newPatientForm .actions .cancel:hover { background: #bbb; }
        #newPatientForm .actions .save { background: #e85d75; }
        #newPatientForm .actions .save:hover { background: #d44d62; }
    </style>
</head>
<body>
    <div id="generalInfoContainer">
        <div class="toolbar">
            <button id="toolbarNewPatientBtn">+ Neuer Patient</button>
            <button id="addNoteBoxBtn">+ Notiz hinzufügen</button>
            <button id="toolbarShowArchiveModalBtn">Vorlage / Archiv</button>
            <button id="archiveCurrentPatientBtn">Aktuellen Patienten archivieren</button>
        </div>

        <h2>Allgemeine Patienteninformationen</h2>
        <div class="info-container">
            <div class="info-box personal">
                <h3>Patientenakte</h3>
                <div class="patient-details-grid">
                    <p><strong>Name:</strong> <span id="patientName">Bitte Patient auswählen</span></p>
                    <p><strong>Geburtsdatum:</strong> <span id="patientDob"></span></p>
                    <p><strong>Geschlecht:</strong> <span id="patientGender"></span></p>
                    <p><strong>Kontakt:</strong> <span id="patientContact"></span></p>
                    <p><strong>Patienten-ID:</strong> <span id="patientId"></span></p>
                    <p><strong>Geburtsort:</strong> <span id="patientBirthplace"></span></p>
                    <p><strong>Stadt:</strong> <span id="patientCity"></span></p>
                    <p><strong>Krankenkasse:</strong> <span id="patientInsurance"></span></p>
                    <p class="full-width"><strong>Vorläufige Diagnose:</strong> <span id="patientDiagnosis"></span></p>
                    <p class="full-width"><strong>Aktuelles Krankheitsbild:</strong> <span id="patientHistory"></span></p>
                    <p class="full-width"><strong>Bisherige Behandlungen:</strong> <span id="patientTreatments"></span></p>
                </div>
                <div class="patient-actions">
                    <button id="selectPatientBtn">Patient auswählen</button>
                    <button id="clearPatientSelectionBtn" style="display:none;">Patient abwählen</button>
                    <button id="deletePatientBtn" style="display:none;">Patient löschen</button>
                </div>
            </div>

            <div class="info-box">
                <h3>Behandlungsfortschritt</h3>
                <p>Komplettierungsgrad: <span id="progressPercentage">0%</span></p>
                <div class="progress-bar">
                    <div class="progress" id="progressBar"></div>
                </div>
                <p>Nächster Schritt: <span id="nextStep">Patientendaten vervollständigen</span></p>
            </div>

            <div class="info-box notes-box full-width">
                <h3>Patientennotizen</h3>
                <textarea id="patientNotesContent" rows="10" placeholder="Hier können Sie allgemeine Notizen zum Patienten eintragen..."></textarea>
                <button id="savePatientNotesBtn">Notizen speichern</button>
            </div>
        </div>

        <div id="patientSelectionModal" class="modal">
            <div class="modal-content">
                <span class="close-button" id="closePatientSelectionModal">&times;</span>
                <h2>Patienten auswählen</h2>
                <input type="text" id="patientSearchInput" placeholder="Suchen nach Name oder ID..." style="width: calc(100% - 22px); padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px;">
                <ul id="patientList" class="modal-list-group">
                    </ul>
            </div>
        </div>

        <div id="newPatientModal" class="modal">
            <div class="modal-content">
                <span class="close-button" id="closeNewPatientModal">&times;</span>
                <h3>Neuen Patienten anlegen</h3>
                <form id="newPatientForm">
                    <label for="newFirstName">Vorname</label>
                    <input id="newFirstName" name="first" required>

                    <label for="newLastName">Nachname</label>
                    <input id="newLastName" name="last" required>

                    <label for="newDob">Geburtsdatum</label>
                    <input id="newDob" name="dob" type="date" required>

                    <label for="newGender">Geschlecht:</label>
                    <select id="newGender" required>
                        <option value="">Wählen Sie...</option>
                        <option value="männlich">Männlich</option>
                        <option value="weiblich">Weiblich</option>
                        <option value="divers">Divers</option>
                    </select>

                    <label for="newContact">Kontakt:</label>
                    <input type="text" id="newContact" placeholder="Telefon oder E-Mail" required>

                    <label for="newBirthplace">Geburtsort</label>
                    <input id="newBirthplace" name="birthplace">

                    <label for="newCity">Stadt</label>
                    <input id="newCity" name="city">

                    <label for="newInsurance">Krankenkasse</label>
                    <input id="newInsurance" name="insurance">

                    <label for="newDiagnosis">Vorläufige Diagnose:</label>
                    <textarea id="newDiagnosis" rows="3" placeholder="Kurze Beschreibung"></textarea>

                    <label for="newHistory">Aktuelles Krankheitsbild</label>
                    <textarea id="newHistory" name="history" rows="3"></textarea>

                    <label for="newTreatments">Bisherige Behandlungen</label>
                    <textarea id="newTreatments" name="treatments" rows="3"></textarea>

                    <div class="actions">
                        <button type="button" class="cancel" id="cancelNewPatientBtn">Abbrechen</button>
                        <button type="submit" class="save">Speichern</button>
                    </div>
                </form>
            </div>
        </div>

        <div id="archiveModal" class="modal">
            <div class="modal-content">
                <span class="close-button" id="closeArchiveModal">&times;</span>
                <h3>Vorlagen</h3>
                <ul id="templateList">
                    </ul>
                <hr>
                <h3>Archivierte Patienten</h3>
                <ul id="archiveList">
                    </ul>
                <button id="archiveModalCloseBtn">Schließen</button>
            </div>
        </div>
    </div>

    <script src="patient-store.js"></script>
    <script src="general-info.js"></script>
</body>
</html>